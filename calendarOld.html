<html>
  <body>
    <div id='content'>
		<h1>Events</h1>
		Start Date: <input type='date' id='startDate'>
		End Date: <input type='date' id='endDate'><br>
		<button id='list-button' onclick='listApiCall();'>List All Events</button>
		<button id='event-button' onclick='eventApiCall();'>Get Events By Date Range</button>
		
		<div id='events'></div>
    </div>
    
  <script>
		var clientId = '546498004309-96bjperag6n0j26u8jq72il7b38qe7lk';
		var apiKey = 'AIzaSyDD4GFAtboKMj9DjyPzIyBqriazbJ5SQ2A';
		var scopes = 'https://www.googleapis.com/auth/calendar';
		function handleClientLoad() {
		  gapi.client.setApiKey(apiKey);
		  window.setTimeout(checkAuth,1);
		  checkAuth();
		}

		function checkAuth() {
		  gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true},
			  handleAuthResult);
		}

		function handleAuthResult(authResult) {
		  if (authResult) {
			//listButton.style.visibility = 'hidden';
			//makeApiCall();
		  } else {
			listButton.style.visibility = '';
			listButton.onclick = handleAuthClick;
		   }
		}

		function handleAuthClick(event) {
			gapi.auth.authorize(
			  {client_id: clientId, scope: scopes, immediate: false},
			  handleAuthResult);
			return false;
		}
		
		function listApiCall() {

			gapi.client.load('calendar', 'v3', function() {
			var request = gapi.client.calendar.events.list({
			  'calendarId': 'pattee13@gmail.com'
			});
				  
			request.execute(function(resp) {
			  for (var i = 0; i < resp.items.length; i++) {
				var h2 = document.createElement('H2');
				h2.appendChild(document.createTextNode(resp.items[i].summary));
				document.getElementById('events').appendChild(h2);
			  }
			});
			});
		}
		
		function eventApiCall() {
			if (document.getElementById('startDate').value !== '' || document.getElementById('startDate').value !== null) {
			var startDate = document.getElementById('startDate').value;
			} else {
				startDate = '2014-12-01';
			}
			
			if (document.getElementById('endDate').value !== '' || document.getElementById('endDate').value !== null) {
			var maxDate = document.getElementById('endDate').value;
			} else {
				maxDate = '2014-12-31';
			}
			
			startDate = startDate + 'T11:43:22.000Z';
			maxDate = maxDate + 'T11:43:22.000Z';
			console.log(startDate);
			
			gapi.client.load('calendar', 'v3', function() {
				var request = gapi.client.calendar.events.list({
				  'calendarId': 'pattee13@gmail.com',
				  'singleEvents': true, /* required to use timeMin */ 
				  'timeMin': startDate,
				  'timeMax': maxDate
				});
				  
				request.execute(function(resp) {
				  for (var i = 0; i < resp.items.length; i++) {
					var title = document.createTextNode(resp.items[i].summary); 
					var date = document.createTextNode('Start: ' + resp.items[i].start.date + ' End: ' + resp.items[i].end.date);

					var div = document.createElement('div');
					var h2 = document.createElement('h2');
					h2.appendChild(title);
					div.appendChild(h2);
					var p = document.createElement('p');
					p.appendChild(date);
					div.appendChild(p);
					document.body.appendChild(h2);
					document.body.appendChild(div);
				  }
				});
			});
		}
		
		
    </script>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
  </body>
</html>

      
